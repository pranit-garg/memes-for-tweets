{
  "feature": "Meme Matching Engine Improvements",
  "branchName": "improve-meme-matching",
  "description": "Substantially improve the quality, relevance, and humor of meme matches for tweets",
  "userStories": [
    {
      "id": "MM-001",
      "title": "Add tweet analysis step before matching",
      "description": "Before matching, analyze the tweet to extract: sentiment, humor type (sarcasm, irony, hot take, complaint, observation), key entities, and the core joke/point. This structured analysis feeds into better template selection.",
      "acceptanceCriteria": [
        "Create analyzeTweet() function that returns structured analysis",
        "Include sentiment (positive/negative/neutral/mixed)",
        "Identify humor type from predefined categories",
        "Extract key subjects/entities mentioned",
        "Summarize the core point in one sentence"
      ],
      "priority": 1,
      "passes": true,
      "completedAt": "2026-01-16"
    },
    {
      "id": "MM-002",
      "title": "Implement template scoring system",
      "description": "Score all curated templates based on fit to the analyzed tweet, then select top templates for AI to choose from.",
      "acceptanceCriteria": [
        "Create scoreTemplates() function",
        "Score based on: format fit, humor alignment, specificity",
        "Return top-scoring templates with scores",
        "Include reasoning for each score"
      ],
      "priority": 2,
      "passes": true,
      "completedAt": "2026-01-16"
    },
    {
      "id": "MM-003",
      "title": "Add caption generation as separate step",
      "description": "Separate template selection from caption generation. First pick templates, then generate captions specifically optimized for each template's format and constraints.",
      "acceptanceCriteria": [
        "Create generateCaptions() function",
        "Takes template + tweet analysis as input",
        "Generates captions optimized per template",
        "Respects template's text box constraints",
        "Captions are punchy (under 8 words per box)"
      ],
      "priority": 3,
      "passes": true,
      "completedAt": "2026-01-16"
    },
    {
      "id": "MM-004",
      "title": "Add self-critique step",
      "description": "After generating matches, have the LLM critique its own suggestions and fix any issues (too long, generic, poor fit).",
      "acceptanceCriteria": [
        "Create critiqueAndRefine() function",
        "Check for: text too long, generic phrases, poor format match",
        "Fix matches that have issues",
        "Approve matches that are good",
        "Log critique results"
      ],
      "priority": 4,
      "passes": true,
      "completedAt": "2026-01-16"
    },
    {
      "id": "MM-005",
      "title": "Expand template database with humor categories",
      "description": "Tag each template in MEME_FORMAT_DATABASE with specific humor categories it excels at (sarcasm, irony, self-deprecation, hot-takes, etc). Use these tags to filter templates before scoring.",
      "acceptanceCriteria": [
        "Add 'humorTags' array to each template in database",
        "Categories: sarcasm, irony, self-deprecation, hot-take, absurdist, wholesome, complaint, flex, roast",
        "Update getMemeFormatInfo to return humor tags",
        "Use humor tags in template scoring"
      ],
      "priority": 5,
      "passes": true,
      "completedAt": "2026-01-16"
    },
    {
      "id": "MM-006",
      "title": "Add example captions to template database",
      "description": "For each curated template, add example captions that demonstrate ideal usage. The LLM can use these as few-shot examples for better caption generation.",
      "acceptanceCriteria": [
        "Add 'exampleCaptions' array to MemeFormatInfo interface",
        "Populate examples for key templates",
        "Examples demonstrate the template's ideal joke structure",
        "Include examples in prompt context for caption generation"
      ],
      "priority": 6,
      "passes": true,
      "completedAt": "2026-01-16"
    },
    {
      "id": "MM-007",
      "title": "Implement A/B testing infrastructure",
      "description": "Add ability to test different matching strategies. Log which templates users select and download to measure success.",
      "acceptanceCriteria": [
        "Add analytics events for: template shown, template selected, meme downloaded",
        "Store strategy version with each event",
        "Create simple dashboard or logging to review performance",
        "Allow switching between matching strategies via env var"
      ],
      "priority": 7,
      "passes": false
    },
    {
      "id": "MM-008",
      "title": "Multi-panel meme caption support",
      "description": "Properly generate captions for multi-panel memes (3-4 text boxes) like Gru's Plan, Clown Applying Makeup, Expanding Brain, etc.",
      "acceptanceCriteria": [
        "Update generateCaptions() to request panel1/panel2/panel3/panel4 texts",
        "Build textBoxes array dynamically based on template format",
        "Include panel-specific instructions in the prompt",
        "Fallback to top/bottom if panels not provided"
      ],
      "priority": 8,
      "passes": true,
      "completedAt": "2026-01-16"
    },
    {
      "id": "MM-009",
      "title": "Topic/context tags for better matching",
      "description": "Add topic tags to templates (tech, work, relationships, food, money, etc) and detect tweet topics for better template matching.",
      "acceptanceCriteria": [
        "Add MemeTopicTag type with categories",
        "Add topicTags to template database",
        "Detect topics in tweet analysis",
        "Score templates based on topic match"
      ],
      "priority": 9,
      "passes": true,
      "completedAt": "2026-01-16"
    },
    {
      "id": "MM-010",
      "title": "Result diversity enforcement",
      "description": "Ensure the 3 returned meme suggestions use different formats - no returning 3 comparison memes for every tweet.",
      "acceptanceCriteria": [
        "Create enforceDiversity() function",
        "Max 2 templates of same format in results",
        "Add diversity instruction to AI prompt",
        "Fill remaining slots with different formats"
      ],
      "priority": 10,
      "passes": true,
      "completedAt": "2026-01-16"
    },
    {
      "id": "MM-011",
      "title": "Caption tone/style variants",
      "description": "Generate captions with different tones (deadpan, exaggerated, absurdist, wholesome, savage) so each meme suggestion feels distinct.",
      "acceptanceCriteria": [
        "Define CaptionTone type with 5 styles",
        "Create TONE_INSTRUCTIONS with style guidance",
        "Assign different tones to each template",
        "Include tone instructions in caption prompt"
      ],
      "priority": 11,
      "passes": true,
      "completedAt": "2026-01-16"
    }
  ],
  "progress": [
    {"date": "2026-01-16", "completed": ["MM-001", "MM-002", "MM-003", "MM-004", "MM-005", "MM-006"]},
    {"date": "2026-01-16", "completed": ["MM-008", "MM-009", "MM-010", "MM-011"]}
  ]
}
